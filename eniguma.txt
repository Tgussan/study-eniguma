# エニグマ

## エニグマの基本情報
* 開発者：シェルビウス
* 国	：ドイツ
* 時期	：20世紀初め
* 意味	：ドイツ語で「謎」
* 使用者：ドイツの軍・商業利用もされていた・・・？

http://www1.accsnet.ne.jp/~hoshos231/howtobreakENIGMA.html

## エニグマによる暗号通信
### 前提
* 1台の機械によって暗号化・複合化を行う事が可能(送信者・受信者ともに必要)
* 日替わりの鍵・通信鍵が必要(日替わりの鍵は国防軍鍵表というものによって決められていた)


### 通信の流れ
図2-5

## エニグマの構造(本と同様にアルファベットを四文字として記述する)
図2-6

### エニグマの操作(暗号化・複合化の場合も同様)
1.入力用キーボードのaを押すと、図のように電気信号が流れ、出力用ランプが点灯する
2.送信者はランプに対応した文字を読み取って紙に書き写す

### 部品説明

#### プラグボード
結線を変えることによって文字の対応を様々に変化させるもの
結線は国防軍鍵表によって定められており、1日の間変化しない

#### ローター
図2-7
表の裏の端子同士が電線でつながっている円盤状の部品
個々のローターの結線を変えることは不可能
取り外し可能で、取り付ける順番や個々のローターの角度を選択可能(日替わりの鍵・通信鍵によって変更される)

##### ローターの動作(アルファベットを4文字とした場合)
文字を入力するごとに自動的に回転する
ローター1:使用者が一文字入力するごとに4分の1回転する
ローター2:ローター1が1回転すると、4分の1回転する
ローター3:ローター2が1回転すると、4分の1回転する

動的に変化する「あみだくじ」のような振る舞いとなる
例：一文字目に入力したa -> Bとなった場合、二文字目のaはBではなくCとなる 

## 暗号化の流れ

通信者が夜という意味のドイツ語「natch」を暗号化して送信する場合
図2-8

### 1.エニグマの設定
送信者は国防軍鍵表を用いて、その日の日替わり鍵に従い、プラグボードの結線・3枚のローターの並べ替えを行う

### 2.通信鍵の暗号化
送信者はアルファベット3文字を決め、暗号化する(通信鍵)

1.送信者が選んだ通信鍵を「psv」とする
2.ローターを日替わり鍵によって設定した状態で、「psvpsv」と2度続けて打鍵する
3.一文字打鍵する毎に点灯したランプを確認し、ランプに対応した文字をメモする
暗号化された通信鍵は「ATCDVT」とする

#### 通信エラーの回避
上記の通信鍵「psv」を2度打鍵した理由は、当時の無線通信は性能が低く、うまく通信できないことがあった為
通信鍵が正しく受信者に届かなければ、受信者は暗号を解読できない。
通信鍵を2度打鍵することによって受信者が通信鍵を検証できるようにした

### 3.エニグマの再設定
通信鍵「psv」に従って3枚のローターの取り付け角度を設定する

ローター1を角度p,ローター2を角度s,ローター3を角度vにする

### 4.メッセージの暗号化
メッセージを1文字ずつキーボードから入力し、ランプに対応した文字をメモする
平文「natch」　−＞　暗号文「KXNWP」とする



### 5.通信鍵とメッセージの結合
暗号化された通信鍵「ATCDVT」と暗号文「KXNWP」を結合する
結合された文字列「ATCDVTKXNWP」を無線で送信する

